library(readxl)
library(dplyr)
library(caTools)
library(caret)
library(rpart)
library(GGally)
library(car)
library(randomForest)
library(MASS)
library(gbm)
library(ie2misc)
companies2005 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2005", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2006 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2006", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2007 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2007", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2008 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2008", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2009 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2009", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2010 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2010", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2011 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2011", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2012 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2012", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2013 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2013", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2016 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2016", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2017 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2017", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2018 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2018", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2019 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2019", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
companies2020 <- read_excel("FASTEST-GROWING COMPANIES.xlsx", sheet = "2020", col_types = c("numeric", "text", "numeric", "numeric","numeric"))
train.data <- na.omit(rbind(companies2005,companies2006,companies2007,companies2008,companies2009,companies2010,
                            companies2011,companies2012,companies2013,companies2016))
test.data2017 <- na.omit(companies2017) 
test.data2018 <- na.omit(companies2018) 
test.data2019 <- na.omit(companies2019)
test.data2020 <- na.omit(companies2020)
#Linear Regression
lm.model <- lm(Rank~EPS_growth+Revenue_growth+Total_return, data = train.data)
summary(lm.model) 
vif(lm.model)
#Testing
lm.pred2017 <- predict(lm.model,newdata = test.data2017) 
lm2017 <- as.numeric(names(sort(lm.pred2017))) 
cbind(test.data2017$Company,lm2017)
mae_lm_2017<-mae(lm2017, 1:100, na.rm = FALSE)
lm.pred2018 <- predict(lm.model,newdata = test.data2018) 
lm2018 <- as.numeric(names(sort(lm.pred2018))) 
cbind(test.data2018$Company,lm2018)
mae_lm_2018<-mae(lm2018, 1:100, na.rm = FALSE)
lm.pred2019 <- predict(lm.model,newdata = test.data2019) 
lm2019 <- as.numeric(names(sort(lm.pred2019))) 
cbind(test.data2019$Company,lm2019)
mae_lm_2019<-mae(lm2019, 1:100, na.rm = FALSE)
lm.pred2020 <- predict(lm.model,newdata = test.data2020) 
lm2020 <- as.numeric(names(sort(lm.pred2020))) 
cbind(test.data2020$Company,lm2020)
mae_lm_2020<-mae(lm2020, 1:100, na.rm = FALSE)
# CART model
set.seed(144)
modcv=train(Rank~EPS_growth+Revenue_growth+Total_return, data=train.data, method="rpart",tuneGrid=data.frame(cp=seq(0,0.04,by=0.001)),
            trControl=trainControl(method = "cv",number=5))
modcv
rpart.model <-rpart(Rank~EPS_growth+Revenue_growth+Total_return, data=train.data,
              method = ,parms =list(split="information"),minbucket=5,cp=0.003)
#Testing
rpart.pred2017 <-predict(rpart.model,newdata=test.data2017)
rpart2017 <-as.numeric(names(sort(rpart.pred2017)))
cbind(test.data2017$Company,rpart2017)
mae_rpart_2017<-mae(rpart2017, 1:100, na.rm = FALSE)
rpart.pred2018 <-predict(rpart.model,newdata=test.data2018)
rpart2018 <-as.numeric(names(sort(rpart.pred2018)))
cbind(test.data2018$Company,rpart2018)
mae_rpart_2018<-mae(rpart2018, 1:100, na.rm = FALSE)
rpart.pred2019 <-predict(rpart.model,newdata=test.data2019)
rpart2019 <-as.numeric(names(sort(rpart.pred2019)))
cbind(test.data2019$Company,rpart2019)
mae_rpart_2019<-mae(rpart2019, 1:100, na.rm = FALSE)
rpart.pred2020 <-predict(rpart.model,newdata=test.data2020)
rpart2020 <-as.numeric(names(sort(rpart.pred2020)))
cbind(test.data2020$Company,rpart2020)
mae_rpart_2020<-mae(rpart2020, 1:100, na.rm = FALSE)
#Random Forest model
CTRRF.model=randomForest(Rank~EPS_growth+Revenue_growth+Total_return, data=train.data)
#Testing
CTRRF.pred2017 <-predict(CTRRF.model,newdata=test.data2017)
CTRRF2017 <-as.numeric(names(sort(CTRRF.pred2017)))
cbind(test.data2017$Company,CTRRF2017)
mae_CTRRF_2017<-mae(CTRRF2017, 1:100, na.rm = FALSE)
CTRRF.pred2018 <-predict(CTRRF.model,newdata=test.data2018)
CTRRF2018 <-as.numeric(names(sort(CTRRF.pred2018)))
cbind(test.data2018$Company,CTRRF2018)
mae_CTRRF_2018<-mae(CTRRF2018, 1:100, na.rm = FALSE)
CTRRF.pred2019 <-predict(CTRRF.model,newdata=test.data2019)
CTRRF2019 <-as.numeric(names(sort(CTRRF.pred2019)))
cbind(test.data2019$Company,CTRRF2019)
mae_CTRRF_2019<-mae(CTRRF2019, 1:100, na.rm = FALSE)
CTRRF.pred2020 <-predict(CTRRF.model,newdata=test.data2020)
CTRRF2020 <-as.numeric(names(sort(CTRRF.pred2020)))
cbind(test.data2020$Company,CTRRF2020)
mae_CTRRF_2020<-mae(CTRRF2020, 1:100, na.rm = FALSE)


